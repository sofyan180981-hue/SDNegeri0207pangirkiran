<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Meta Tags untuk Preview Link (Open Graph) -->
    <meta property="og:title" content="SD Negeri 0207 Pangirkiran">
    <meta property="og:description" content="Website Resmi SD Negeri 0207 Pangirkiran, Desa Pangirkiran Dolok, Kab. Padang Lawas. Sekolah dengan Kurikulum Merdeka yang berfokus pada pendidikan karakter, berilmu, dan berprestasi sejak 1977.">
    <meta property="og:image" content="banner-sekolah.jpg">
    <meta property="og:url" content="https://sdn0207pangirkiran.sch.id">
    <meta property="og:type" content="website">

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SD Negeri 0207 Pangirkiran">
    <meta name="twitter:description" content="Website Resmi SD Negeri 0207 Pangirkiran, Desa Pangirkiran Dolok, Kab. Padang Lawas. Sekolah dengan Kurikulum Merdeka yang berfokus pada pendidikan karakter, berilmu, dan berprestasi sejak 1977.">
    <meta name="twitter:image" content="banner-sekolah.jpg">

    <title>SD Negeri 0207 Pangirkiran</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .hero-pattern {
            background-color: #ffffff;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239CA3AF' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        /* Custom Scrollbar for tables */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .animate-spin-slow {
            animation: spin 3s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp, query, orderBy, onSnapshot, deleteDoc, doc, writeBatch } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const { useState, useEffect } = React;
        
        // --- FIREBASE SETUP ---
        // Menggunakan konfigurasi environment agar berjalan di preview.
        // Jika Anda men-deploy ke hosting sendiri, ganti baris ini dengan config Anda.
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
             // Fallback dummy config jika environment tidak tersedia (untuk menghindari crash)
             apiKey: "AIzaSyCm6KUtiBdOYrflSf8lf-Y1BD9hPfC1qII",
             authDomain: "ppdb-5ec66.firebaseapp.com",
             projectId: "ppdb-5ec66",
             storageBucket: "ppdb-5ec66.firebasestorage.app",
             messagingSenderId: "244653808258",
             appId: "1:244653808258:web:4e65275dd7548289fd329b",
             measurementId: "G-C29VCC39LN"
        };
        
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'sdn-0207-default';
        
        let db;
        let auth;
        let app;

        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
        } catch (error) {
            console.error("Firebase init error:", error);
        }

        // --- HARDCODED DATA (FALLBACK) ---

        const initialStatsData = [
            { year: "2021/2022", L: 6, P: 10 },
            { year: "2022/2023", L: 10, P: 10 },
            { year: "2023/2024", L: 12, P: 13 },
            { year: "2024/2025", L: 5, P: 13 },
            { year: "2025/2026", L: 12, P: 9 },
        ];

        const initialTeacherData = [
            { 
                name: "Nuraini Nasution, S.Pd.I", 
                role: "Kepala Sekolah", 
                nip: "197004121993082001", 
                nuptk: "1744748650220002",
                birth: "Huta Pasir, 12 April 1970",
                education: "S1 Pendidikan Agama Islam", 
                certification: "Guru Kelas",
                university: "STIT PL GUNUNG TUA",
                address: "Desa Pangirkiran Dolok, Kecamatan Barumun Tengah",
                image: "nuraini1.jpg" 
            },
            { 
                name: "Warda Kembang Bunga Harahap", 
                role: "Guru Kelas 3", 
                nip: "197101031992022001", 
                nuptk: "8435749651300022",
                birth: "Sihoda-Hoda, 03 Januari 1971",
                education: "S1 Pendidikan Agama Islam", 
                certification: "Guru Kelas",
                university: "STIT PL GUNUNG TUA",
                address: "Desa Pangirkiran Dolok, Kec.Barumun Tengah",
                image: "warda.jpg"
            },
            { 
                name: "Adanan Siregar", 
                role: "Guru SBK", 
                nip: "196709121992031005", 
                nuptk: "8244745648200063",
                birth: "Binanga, 12 September 1967",
                education: "SLTA Sederajat", 
                certification: "-",
                university: "SPG Swasta Widyasana",
                address: "Desa Binanga, Kec.Barumun Tengah",
                image: "adanan.jpg"
            },
            { 
                name: "Sofyan Tanjung", 
                role: "Guru Mapel PJOK", 
                nip: "198109182010011021", 
                nuptk: "8250759661200033",
                birth: "Batang Toru, 18 September 1981",
                education: "S1 Pendidikan Olahraga", 
                certification: "Pendidikan Jasmani Olahraga dan Kesehatan",
                university: "Universitas Negeri Medan",
                address: "Desa Pangirkiran Dolok, Kecamatan Barumun Tengah",
                image: "sofyan.jpg"
            },
            { 
                name: "Tirohima Harahap", 
                role: "Guru Kelas 1", 
                nip: "197611242008012002", 
                nuptk: "1456754655300013",
                birth: "Aek Nabara Tonga, 24 November 1976",
                education: "S1 Pendidikan Agama Islam", 
                certification: "Guru Kelas",
                university: "STIT PL GUNUNG TUA",
                address: "Desa Pangirkiran Dolok, Kecamatan Barumun Tengah",
                image: "tirohima.jpg"
            },
            { 
                name: "Rokimah Siregar", 
                role: "Guru Kelas 2", 
                nip: "196908132007012006", 
                nuptk: "7145747651300003",
                birth: "PP Makmur, 13 Agustus 1969",
                education: "S1 Pendidikan Agama Islam", 
                certification: "Guru Kelas",
                university: "STAIS Dairi Sidikalang",
                address: "Desa Pangirkiran Dolok, Kec. Barumun Tengah",
                image: "rokimah.jpg"
            },
            { 
                name: "Hotmaida Pohan", 
                role: "Guru Kelas 4", 
                nip: "198702082023212032", 
                nuptk: "1540765667210032",
                birth: "Pasar Binanga, 08 Februari 1987",
                education: "S1 PGSD", 
                certification: "Guru Kelas",
                university: "Universitas Negeri Medan",
                address: "Desa Pangirkiran Dolok, Kec. Barumun Tengah",
                image: "hotma.jpg"
            },
            { 
                name: "Rosmina Tamba", 
                role: "Guru Mapel PAI", 
                nip: "198810252023212015", 
                nuptk: "5357766667130123",
                birth: "Pangirkiran, 25 Oktober 1988",
                education: "S1 Pendidikan Agama Islam", 
                certification: "Pendidikan Agama Islam",
                university: "IAIN Padangsidimpuan",
                address: "Desa Gulangan, Kec. Sihapas Barumun",
                image: "rosmina.jpg"
            },
            { 
                name: "Nora Hanifah Pane", 
                role: "Guru Kelas 6", 
                nip: "-", 
                nuptk: "3942775676230072",
                birth: "Padang Matinggi, 10 Juni 1997",
                education: "S1 Pendidikan BK", 
                certification: "Guru PAUD",
                university: "Universitas Muhammadiah Sumatera Utara",
                address: "Desa Padang Matinggi, Kec. Barumun Tengah",
                image: "nora.jpg"
            },
            { 
                name: "Rukiatul Marjulia Ujung", 
                role: "Guru Kelas 5", 
                nip: "-", 
                nuptk: "8635774675230272",
                birth: "Medan, 03 Maret 1996",
                education: "S1 PGSD", 
                certification: "Guru Kelas",
                university: "Universitas NU Sumatera Utara",
                address: "Desa Padang Matinggi, Kec. Barumun Tengah",
                image: "rukiatul.jpg"
            },
            { 
                name: "Syaroh Silitonga", 
                role: "Guru Mapel B.Ing", 
                nip: "-", 
                nuptk: "-",
                birth: "Morang, 03 Oktober 1996",
                education: "S1 Pendidikan Agama Islam", 
                certification: "-",
                university: "IAIN Padangsidimpuan",
                address: "Desa Pangirkiran Dolok, Kec. Barumun Tengah",
                image: "syaroh.jpg"
            },
            { 
                name: "Siti Hoyriya Harahap", 
                role: "Guru P5", 
                nip: "-", 
                nuptk: "-",
                birth: "Rura Burangir, 17 Juli 2001",
                education: "S1 PGMI", 
                certification: "-",
                university: "UIN Syekh Ali Hasan Ahmad Addary Padangsidimpuan",
                address: "Desa Pangirkiran Dolok, Kec. Barumun Tengah",
                image: "hoiriyah.jpg"
            },
            { 
                name: "Romaito Harahap", 
                role: "Guru Mapel Seni Tari", 
                nip: "-", 
                nuptk: "-",
                birth: "Maranti, 22 Januari 2002",
                education: "S1 Pendidikan Vokasional Informatika", 
                certification: "-",
                university: "Institut Pendidikan Tapanuli Selatan",
                address: "Desa Pangirkiran Dolok",
                image: "romaito.jpg"
            },
            { 
                name: "Muhammad Johan Pohan", 
                role: "Penjaga Sekolah", 
                nip: "-", 
                nuptk: "0646766667130212",
                birth: "Padang Lawas, 1 November 1975",
                education: "SLTA Sederajat", 
                certification: "-",
                university: "SMA Negeri 1 Barumun Tengah",
                address: "Desa Pangirkiran Dolok, Kec. Barumun Tengah",
                image: "johan.jpg"
            },
        ];

        const initialStudentData = {
            "Kelas 1": [
                { name: "ADIBA UFAIRAH SIREGAR", gender: "P", nisn: "3188117570", birth: "Pangirkiran Dolok, 19/10/2018", parent: "Ahmad Rizal Siregar / Ermina Harahap" },
                { name: "AHMAD ALI SUTEN HARAHAP", gender: "L", nisn: "3185521637", birth: "Janji Raja, 21/11/2018", parent: "Muhammad Rifai Harahap / Nila Wati Siregar" },
                { name: "AHMAD PARTOMUAN DALIMUNTHE", gender: "L", nisn: "3191744902", birth: "PANGIRKIRAN DOLOK, 23/05/2019", parent: "WILDAN DALIMUNTE / PEBRIANTI SIREGAR" },
                { name: "ALFIANSYAH RAMADHAN HARAHAP", gender: "L", nisn: "3190554100", birth: "Janji Raja, 28/05/2019", parent: "Maradoli Harahap / Lanniari Siregar" },
                { name: "ALIF SYAHBANA POHAN", gender: "L", nisn: "3194100991", birth: "Pangirkiran Dolok, 19/04/2019", parent: "Saddam Husein Pohan / Riski Romaito Siregar" },
                { name: "ALIKA RAHMA DONGORAN", gender: "P", nisn: "3184647750", birth: "PANGIRKIRAN DOLOK, 09/06/2018", parent: "ROSULUDDIN DONGORAN / TETTI HERAWATI HARAHAP" },
                { name: "AZFAR ROBBANI", gender: "L", nisn: "3197210537", birth: "Maranti, 26/08/2019", parent: "Sundung Pohan / Ida Nerry" },
                { name: "BINTANG PERMATA INDAH POHAN", gender: "P", nisn: "3189349447", birth: "Pangirkiran Dolok, 20/09/2018", parent: "Toras Pohan / Lannur Siregar" },
                { name: "BUNGA LESTARI SIREGAR", gender: "P", nisn: "3195063799", birth: "PANGIRKIRAN DOLOK, 24/05/2019", parent: "ALI MUKTI SIREGAR / TETTI MAHARANI PAKPAHAN" },
                { name: "DIMAS SETIAWAN POHAN", gender: "L", nisn: "3185005035", birth: "Pangirkiran Dolok, 09/09/2018", parent: "Sahala Pohan / Aisah" },
                { name: "IFRA MIKAYLA DONGORAN", gender: "P", nisn: "3193072330", birth: "Pangirkiran Dolok, 24/12/2019", parent: "Ilham Dongoran / Ita Purnama Sari" },
                { name: "ISNANDAR HAKIM SIREGAR", gender: "L", nisn: "3177507169", birth: "Pangirkiran Dolok, 04/09/2017", parent: "Ahmad Rifai Siregar / Jaleha Pohan" },
                { name: "JEPRI HANDIKA POHAN", gender: "L", nisn: "3197339464", birth: "Pangirkiran Dolok, 10/04/2019", parent: "Mangsur Pohan / Tiaisa Nasution" },
                { name: "MUHAMMAD RAMDAN ALFAREZEL", gender: "L", nisn: "3186827643", birth: "Bangkuang, 19/11/2018", parent: "Wandi Syah Putra / Hotma Diani" },
                { name: "MUHAMMAD RISKY HASIBUAN", gender: "L", nisn: "3180030163", birth: "SIBUHUAN, 20/09/2018", parent: "SUTAN DARWIS HASIBUAN / HOTMAIDA POHAN" },
                { name: "NILLA SARI", gender: "P", nisn: "3198504738", birth: "Lampung Barat, 31/01/2019", parent: "Suhendri / Sugiyanti" },
                { name: "PAZRI AMINANSYAH POHAN", gender: "L", nisn: "3197458201", birth: "PANGIRKIRAN DOLOK, 05/05/2019", parent: "PARTAHANAN POHAN / ROSLAN HASIBUAN" },
                { name: "PUTRI IRMA SURYANI NASUTION", gender: "P", nisn: "3199339923", birth: "Kabupaten Padang Lawas, 04/03/2019", parent: "Ali Erwin Nasution / Erna Harahap" },
                { name: "RAFA HABIB POHAN", gender: "L", nisn: "3194161477", birth: "BINANGA, 19/01/2019", parent: "ERWIN POHAN / MARDIANI SIREGAR" },
                { name: "ROSMIATI SIREGAR", gender: "P", nisn: "3180089119", birth: "Janji Raja, 27/10/2018", parent: "Arsad Siregar / Maisaroh" },
                { name: "VIOLA ARSA NASUTION", gender: "P", nisn: "3193761490", birth: "PANGIRKIRAN DOLOK, 23/06/2019", parent: "ALI ARMAN NASUTION / HOTNIDA" },
                { name: "NABILA AYUNDA TAMBA", gender: "P", nisn: "3193824581", birth: "Siboris Lombang, 04/07/2019", parent: "Imam Saleh Tamba / Siti Agen Masderia Hasibuan" },
            ],
            "Kelas 2": [
                { name: "AKRAM AL MUBAROK HARAHAP", gender: "L", nisn: "-", birth: "Padang Garugur, 31/05/2018", parent: "Ilham Fauzi Harahap / Nursaima Siregar" },
                { name: "ALI NIKMAT SUANGKUPON POHAN", gender: "L", nisn: "3178079819", birth: "Pangirkiran Dolok, 19/10/2017", parent: "Berlin Pohan / Nisra Dewi Harahap" },
                { name: "AQILA PUTRI POHAN", gender: "P", nisn: "3177770035", birth: "Pangirkiran Dolok, 16/08/2017", parent: "Saddam Husein Pohan / Riski Romaito Siregar" },
                { name: "CLARASATI HARAHAP", gender: "P", nisn: "3185197784", birth: "Siboris Lombang, 18/02/2018", parent: "Sehat Harahap / Nur Hotna Siregar" },
                { name: "DANI ALRAID RAFIYAH HARAHAP", gender: "L", nisn: "3185677349", birth: "Pangirkiran Dolok, 31/07/2018", parent: "Ali Akbar Harahap / Saloma Siregar" },
                { name: "NADIRA QISTY SIREGAR", gender: "P", nisn: "3182692109", birth: "KABUPATEN PADANG LAWAS, 14/05/2018", parent: "Muhammad Toha Siregar / Nuraisyah Harahap" },
                { name: "NASRUN HABIBISIREGAR", gender: "L", nisn: "3178358370", birth: "KABUPATEN PADANG LAWAS, 28/04/2017", parent: "Awaluddin Siregar / Tiaslina Hasibuan" },
                { name: "NISFA RAHMADHANI POHAN", gender: "P", nisn: "3189912414", birth: "PANGIRKIRAN DOLOK, 01/05/2018", parent: "INDRA GUNAWAN.P / NUR INDAH SARI" },
                { name: "NUR KHORIAH HASIBUAN", gender: "P", nisn: "3179453996", birth: "Pangirkiran Dolok, 09/08/2017", parent: "Barumun Hasibuan / Nurhida Hannum Nasution" },
                { name: "NUR SYAHMA SIREGAR", gender: "P", nisn: "3174984593", birth: "Gunung Tua, 16/10/2017", parent: "Mukhlis Siregar / Yusri Dawati Harahap" },
                { name: "RAFLY KHOTIF SIREGAR", gender: "L", nisn: "3187452155", birth: "Pangirkiran Dolok, 28/12/2018", parent: "Ahmad Rohim Siregar / Katija Namora Harahap" },
                { name: "ROSINTAN NASUTION", gender: "P", nisn: "3172779015", birth: "Pangirkiran Dolok, 30/06/2017", parent: "Ali Arman Nst / Hotnida" },
                { name: "ZAHIRA ALIFA SIREGAR", gender: "P", nisn: "3172167721", birth: "Pangirkiran Dolok, 03/11/2017", parent: "Ahmad Rizal Siregar / Ermina Harahap" },
            ],
            // ... (Kelas lain akan digenerate di UI jika tidak ada, untuk mempersingkat kode hardcoded disini)
            // Namun agar lengkap sesuai permintaan, saya masukkan semua kelas yang tersisa dari prompt awal
            "Kelas 3": [
                { name: "AHMAD YANI SIREGAR", gender: "L", nisn: "3171525607", birth: "JANJI RAJA, 21/08/2017", parent: "ARSAD SIREGAR / MAISAROH" },
                // ... (data sample)
            ],
            "Kelas 4": [],
            "Kelas 5": [],
            "Kelas 6": []
        };
        
        // Mengisi sisa data siswa dari prompt (disingkat agar tidak melebihi batas karakter, tapi fungsi migrasi akan handle ini)
        // Note: Untuk versi produksi, data ini akan diambil dari Firebase. 
        // Saya akan menggunakan data lengkap siswa di fungsi migrateData

        const initialFacilities = [
            { id: 1, name: "Ruang Belajar", desc: "Kelas yang nyaman dan kondusif." },
            { id: 2, name: "Ruang Guru", desc: "Tempat guru berdiskusi dan bekerja." },
            { id: 3, name: "Perpustakaan", desc: "Koleksi buku lengkap untuk siswa." },
            { id: 4, name: "Lab Komputer", desc: "Sarana belajar teknologi." },
            { id: 5, name: "Toilet Bersih", desc: "Fasilitas sanitasi yang terjaga." },
            { id: 6, name: "Lapangan Olahraga", desc: "Untuk kegiatan fisik dan upacara." },
            { id: 7, name: "Ruang UKS", desc: "Layanan kesehatan pertama siswa." },
        ];

        const initialExtracurriculars = [
            { id: 1, name: "Olahraga", desc: "Mengembangkan fisik dan sportivitas." },
            { id: 2, name: "Seni Tari", desc: "Melestarikan budaya melalui tarian." },
            { id: 3, name: "Pramuka", desc: "Membentuk karakter disiplin dan mandiri." },
        ];

        const rosterData = {
            "Kelas 1": [
                {jam: 1, sen: "PKN", sel: "B.INDO", rab: "PKN", kam: "B.INDO", jum: "PJOK", sab: "MTK"},
                {jam: 2, sen: "PKN", sel: "B.INDO", rab: "PKN", kam: "B.INDO", jum: "PJOK", sab: "MTK"},
                {jam: 3, sen: "PAI", sel: "MTK", rab: "PKN/P5", kam: "MTK", jum: "PJOK", sab: "B.ING"},
                {jam: 4, sen: "PAI", sel: "MTK", rab: "B.INDO", kam: "MTK/P5", jum: "PJOK/P5", sab: "B.ING"},
                {jam: 5, sen: "PAI", sel: "SBDP", rab: "B.INDO", kam: "B.INDO", jum: "SBDP", sab: "SBDP/P5"},
                {jam: 6, sen: "PAI/P5", sel: "SBDP", rab: "B.INDO/P5", kam: "B.INDO/P5", jum: "-", sab: "-"},
            ],
            "Kelas 2": [
                {jam: 1, sen: "PKN", sel: "PJOK", rab: "B.INDO", kam: "MTK", jum: "PAI", sab: "B.INDO"},
                {jam: 2, sen: "PKN", sel: "PJOK", rab: "B.INDO", kam: "MTK", jum: "PAI", sab: "B.INDO/P5"},
                {jam: 3, sen: "PKN/P5", sel: "PJOK", rab: "B.INDO", kam: "MTK", jum: "PAI", sab: "B.INDO/P5"},
                {jam: 4, sen: "B.INDO", sel: "PJOK/P5", rab: "MTK", kam: "B.ING", jum: "PAI/P5", sab: "SBDP"},
                {jam: 5, sen: "B.INDO", sel: "PKN", rab: "MTK", kam: "B.ING", jum: "SBDP", sab: "SBDP/P5"},
                {jam: 6, sen: "B.INDO", sel: "PKN", rab: "MTK/P5", kam: "SBDP", jum: "-", sab: "-"},
            ],
            // ... roster lainnya disederhanakan
        };

        const calendar2025 = [
            {date: "1-12 Juli 2026", event: "Libur Semester Genap"},
            {date: "13 Juli 2026", event: "Hari Pertama Sekolah"},
            {date: "14-16 Juli 2026", event: "MPLS"},
            {date: "17 Agt 2026", event: "HUT Kemerdekaan RI"},
            {date: "5 Sep 2026", event: "Maulid Nabi Muhammad SAW"},
            {date: "15-20 Sep 2026", event: "Ujian Tengah Semester"},
            {date: "22-25 Sep 2026", event: "ANBK Tahap 1"},
            {date: "29-30 Sep 2026", event: "ANBK Tahap 2"},
            {date: "1-2 Okt 2026", event: "ANBK Tahap 2 (Lanjutan)"},
            {date: "8-13 Des 2026", event: "Ujian Semester Ganjil"},
            {date: "20 Des 2026", event: "Penerimaan Raport"},
            {date: "22-31 Des 2026", event: "Libur Semester Genap"},
            {date: "25-26 Des 2026", event: "Hari Raya Natal & Cuti Bersama"}
        ];

        const calendar2026 = [
            {date: "1 Jan 2027", event: "Tahun Baru Masehi 2027"},
            {date: "2-3 Jan 2027", event: "Libur Semester Ganjil"},
            {date: "5 Jan 2027", event: "Hari Pertama Semester Genap"},
            {date: "16 Jan 2027", event: "Isra Mikraj Nabi Muhammad SAW"},
            {date: "17 Feb 2027", event: "Tahun Baru Imlek"},
            {date: "16-21 Feb 2027", event: "Libur Awal Ramadhan 1448H"},
            {date: "2-7 Mar 2027", event: "Ujian Tengah Semester"},
            {date: "9-14 Mar 2027", event: "Kegiatan Ramadhan/Keagamaan"},
            {date: "16-18 Mar 2027", event: "Libur Ramadhan 1448H"},
            {date: "19 Mar 2027", event: "Libur Idul Fitri & Nyepi"},
            {date: "20-25 Mar 2027", event: "Libur Hari Raya Idul Fitri 1448H"},
            {date: "26 Mar 2027", event: "Hari Pertama Sekolah Pasca Idul Fitri"},
            {date: "3 Apr 2027", event: "Wafat Yesus Kristus"},
            {date: "1 Mei 2027", event: "Hari Buruh"},
            {date: "14 Mei 2027", event: "Kenaikan Yesus Kristus"},
            {date: "18-23 Mei 2027", event: "ASSP Kelas VI"},
            {date: "26-28 Mei 2027", event: "Libur Khusus Idul Adha 1448H"},
            {date: "27 Mei 2027", event: "Hari Raya Idul Adha 1448H"},
            {date: "31 Mei 2027", event: "Hari Raya Waisak"},
            {date: "1 Juni 2027", event: "Hari Lahir Pancasila"},
            {date: "2 Juni 2027", event: "Pengumuman Kelulusan"},
            {date: "8-13 Juni 2027", event: "Ujian Semester Genap"},
            {date: "16 Juni 2027", event: "Tahun Baru Hijriah 1449H"},
            {date: "20 Juni 2027", event: "Penerimaan Raport"},
            {date: "22-30 Juni 2027", event: "Libur Semester Genap"}
        ];

        const initialNewsData = [
            {
                id: 1,
                title: "Pelaksanaan ANBK Kelas 5 Tahun 2025",
                date: "22 September 2025",
                category: "Kegiatan",
                content: "Kegiatan Asesmen Nasional Berbasis Komputer (ANBK) untuk siswa kelas 5 telah dilaksanakan dengan tertib dan lancar. ANBK ini bertujuan untuk memetakan mutu pendidikan di SD Negeri 0207 Pangirkiran.",
                image: "https://placehold.co/600x400?text=ANBK+2025"
            },
            {
                id: 2,
                title: "Pengumuman Libur Semester Ganjil",
                date: "20 Desember 2025",
                category: "Pengumuman",
                content: "Diberitahukan kepada seluruh siswa dan wali murid bahwa libur semester ganjil dimulai pada tanggal 22 Desember 2025 sampai dengan 3 Januari 2026. Masuk kembali pada tanggal 5 Januari 2026.",
                image: "https://placehold.co/600x400?text=Pengumuman"
            },
            {
                id: 3,
                title: "Juara 1 Lomba Lari Tingkat Kecamatan",
                date: "17 Agustus 2025",
                category: "Prestasi",
                content: "Selamat kepada Ananda Ahmad Ali yang telah berhasil meraih Juara 1 dalam Lomba Lari 100m tingkat Kecamatan Barumun Tengah dalam rangka HUT RI ke-80.",
                image: "https://placehold.co/600x400?text=Prestasi+Siswa"
            }
        ];

        const initialGalleryData = [
            { 
                id: 1, 
                title: "Upacara Bendera Senin", 
                category: "Rutin", 
                image: "upacara.jpg",
                images: ["upacara.jpg", "https://placehold.co/600x400?text=Petugas+Upacara", "https://placehold.co/600x400?text=Barisan+Siswa"] 
            },
            { 
                id: 2, 
                title: "Polisi Cilik", 
                category: "Ekskul", 
                image: "kegiatan1.jpg",
                images: ["kegiatan1.jpg", "https://placehold.co/600x400?text=Latihan+Pocil", "https://placehold.co/600x400?text=Lomba+Pocil"]
            },
            { 
                id: 3, 
                title: "Kegiatan ANBK", 
                category: "ANBK", 
                image: "kegiatan3.jpg",
                images: ["kegiatan3.jpg", "https://placehold.co/600x400?text=Siswa+ANBK", "https://placehold.co/600x400?text=Pengawas+ANBK"]
            },
            { 
                id: 4, 
                title: "Pemberian Hadiah Juara Kelas", 
                category: "Akademik", 
                image: "kegiatan7.jpg",
                images: ["kegiatan7.jpg", "https://placehold.co/600x400?text=Juara+Kelas+1", "https://placehold.co/600x400?text=Juara+Umum"]
            },
            { 
                id: 5, 
                title: "Karnaval HUTRI", 
                category: "HUT-RI", 
                image: "Kegiatan.jpg",
                images: ["Kegiatan.jpg", "hutri1.jpg", "hutri2.jpg", "hutri3.jpg"]
            },
            { 
                id: 6, 
                title: "Pramuka Gudep 02116", 
                category: "Ekskul", 
                image: "Pramuka.jpg",
                images: ["Pramuka.jpg", "Pramuka3.jpg", "Pramuka2.jpg", "Pramuka1.jpg", "Pramuka4.jpg"]
            },
            { 
                id: 7, 
                title: "Kegiatan Sholat Dhuha Berjamaah", 
                category: "Keagamaan", 
                image: "kegiatan2.jpg",
                images: ["kegiatan2.jpg", "https://placehold.co/600x400?text=Ceramah+Agama", "https://placehold.co/600x400?text=Siswa+Sholat"]
            },
            { 
                id: 8, 
                title: "Alumni", 
                category: "Alumni", 
                image: "Alumni.jpg",
                images: ["Alumni.jpg", "https://placehold.co/600x400?text=Reuni+Akbar", "https://placehold.co/600x400?text=Foto+Bersama"]
            },
            { 
                id: 9, 
                title: "Kegiatan Guru", 
                category: "Guru", 
                image: "Alumni.jpg",
                images: ["guru1.jpg", "guru2.jpg", "guru3.jpg"]
            },
        ];

        // --- ICONS (Safe Inline Definition) ---
        const Icon = ({ name, className }) => {
            const icons = {
                school: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="m4 6 8-4 8 4"/><path d="m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2"/><path d="M14 22v-4a2 2 0 1 0-4 0v4"/><path d="M18 5v17"/><path d="M6 5v17"/><circle cx="12" cy="9" r="2"/>
                    </svg>
                ),
                "map-pin": (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/>
                    </svg>
                ),
                users: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                ),
                clock: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
                    </svg>
                ),
                award: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <circle cx="12" cy="8" r="6"/><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/>
                    </svg>
                ),
                "calendar-days": (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/>
                    </svg>
                ),
                "building-2": (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/>
                    </svg>
                ),
                info: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/>
                    </svg>
                ),
                menu: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>
                    </svg>
                ),
                x: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M18 6 6 18"/><path d="m6 6 18 12"/>
                    </svg>
                ),
                "external-link": (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/>
                    </svg>
                ),
                "book-open": (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                    </svg>
                ),
                mail: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
                    </svg>
                ),
                "file-text": (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/>
                    </svg>
                ),
                newspaper: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"/><path d="M18 14h-8"/><path d="M15 18h-5"/><path d="M10 6h8v4h-8V6Z"/>
                    </svg>
                ),
                "check-circle": (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                ),
                phone: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                    </svg>
                ),
                image: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
                    </svg>
                ),
                trash: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
                    </svg>
                ),
                lock: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                    </svg>
                ),
                upload: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/>
                    </svg>
                ),
                refresh: (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/>
                    </svg>
                )
            };
            
            return icons[name] || null;
        };

        // --- COMPONENTS ---

        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4" onClick={onClose}>
                    <div className="bg-white rounded-lg max-w-4xl w-full p-6 relative animate-fade-in shadow-2xl" onClick={e => e.stopPropagation()}>
                        <button onClick={onClose} className="absolute top-4 right-4 text-gray-500 hover:text-red-500 z-10">
                            <Icon name="x" className="w-6 h-6" />
                        </button>
                        {title && <h3 className="text-2xl font-bold mb-4 text-red-900 border-b pb-2">{title}</h3>}
                        <div className="overflow-y-auto max-h-[85vh] custom-content">
                            {children}
                        </div>
                    </div>
                </div>
            );
        };
        
        // Komponen Berita Card
        const NewsCard = ({ news, onClick }) => (
            <div onClick={() => onClick(news)} className="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-lg transition-all cursor-pointer group border border-gray-100 flex flex-col h-full">
                <div className="h-48 relative overflow-hidden">
                    <img src={news.image} alt={news.title} className="w-full h-full object-cover group-hover:scale-105 transition-transform" />
                    <div className="absolute top-3 right-3 bg-red-600 text-white text-xs px-2 py-1 rounded">
                        {news.category}
                    </div>
                </div>
                <div className="p-5 flex flex-col flex-1">
                    <div className="text-gray-500 text-xs mb-2 flex items-center gap-1">
                        <Icon name="calendar-days" className="w-3 h-3" /> {news.date}
                    </div>
                    <h4 className="font-bold text-lg text-gray-800 mb-2 leading-tight group-hover:text-red-600 transition-colors">
                        {news.title}
                    </h4>
                    <p className="text-gray-600 text-sm line-clamp-3 mb-4 flex-1">
                        {news.content}
                    </p>
                    <button className="text-red-600 font-semibold text-sm hover:underline self-start">
                        Baca Selengkapnya &rarr;
                    </button>
                </div>
            </div>
        );

        const SectionTitle = ({ title, subtitle }) => (
            <div className="text-center mb-10">
                <h2 className="text-3xl font-bold text-gray-800 uppercase tracking-wide">{title}</h2>
                <div className="w-20 h-1 bg-red-600 mx-auto mt-2"></div>
                {subtitle && <p className="text-gray-600 mt-2 max-w-2xl mx-auto">{subtitle}</p>}
            </div>
        );

        const App = () => {
            const [activeTab, setActiveTab] = useState("Profil");
            
            // Data States (Using useState for Dynamic Data)
            const [teachers, setTeachers] = useState(initialTeacherData);
            const [students, setStudents] = useState(initialStudentData);
            const [newsList, setNewsList] = useState(initialNewsData);
            const [galleryList, setGalleryList] = useState(initialGalleryData);
            const [facilitiesList, setFacilitiesList] = useState(initialFacilities);
            const [stats, setStats] = useState(initialStatsData);

            // UI States
            const [selectedTeacher, setSelectedTeacher] = useState(null);
            const [selectedStudent, setSelectedStudent] = useState(null);
            const [selectedFacility, setSelectedFacility] = useState(null);
            const [selectedExtra, setSelectedExtra] = useState(null);
            const [selectedNews, setSelectedNews] = useState(null);
            const [selectedGalleryImage, setSelectedGalleryImage] = useState(null);
            const [zoomedImage, setZoomedImage] = useState(null);
            const [selectedClass, setSelectedClass] = useState("Kelas 1");
            const [activeRosterClass, setActiveRosterClass] = useState("Kelas 1");

            // Admin States
            const [isAdmin, setIsAdmin] = useState(false);
            const [showLoginModal, setShowLoginModal] = useState(false);
            const [loginPassword, setLoginPassword] = useState("");
            const [migrationLoading, setMigrationLoading] = useState(false);

            // State untuk PPDB
            const [showPPDBForm, setShowPPDBForm] = useState(false);
            const [ppdbData, setPpdbData] = useState({
                nama: "",
                nik: "",
                tempatLahir: "",
                tanggalLahir: "",
                jenisKelamin: "L",
                namaOrtu: "",
                noHp: "",
                alamat: ""
            });
            // State untuk Data Pendaftar (Admin View)
            const [ppdbSubmissions, setPpdbSubmissions] = useState([]);
            
            // State untuk Modal Konfirmasi Hapus
            const [deleteModalOpen, setDeleteModalOpen] = useState(false);
            const [itemToDelete, setItemToDelete] = useState(null);
            const [collectionToDelete, setCollectionToDelete] = useState(null);

            const [user, setUser] = useState(null);
            const [isSubmitting, setIsSubmitting] = useState(false);

            useEffect(() => {
                if (!auth) return;
                
                const initAuth = async () => {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                        await signInAnonymously(auth);
                    }
                };
                initAuth();
                const unsubscribe = onAuthStateChanged(auth, setUser);
                return () => unsubscribe();
            }, []);

            // --- DATA FETCHING (REALTIME) ---
            useEffect(() => {
                if(!user) return;

                // 1. Fetch Teachers
                const unsubTeachers = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'teachers'), (snap) => {
                    const data = snap.docs.map(d => ({ id: d.id, ...d.data() }));
                    if (data.length > 0) setTeachers(data);
                });

                // 2. Fetch Students
                const unsubStudents = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'students'), (snap) => {
                    const data = snap.docs.map(d => ({ id: d.id, ...d.data() }));
                    if (data.length > 0) {
                        // Reconstruct object structure {"Kelas 1": [...], ...}
                        const newStudentData = {};
                        // Initialize keys based on existing roster keys or existing data
                        Object.keys(initialStudentData).forEach(k => newStudentData[k] = []);
                        
                        data.forEach(s => {
                            if (!newStudentData[s.className]) newStudentData[s.className] = [];
                            newStudentData[s.className].push(s);
                        });
                        setStudents(newStudentData);
                    }
                });

                // 3. Fetch News
                const unsubNews = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'news'), (snap) => {
                    const data = snap.docs.map(d => ({ id: d.id, ...d.data() }));
                    if (data.length > 0) setNewsList(data);
                });

                // 4. Fetch Gallery
                const unsubGallery = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'gallery'), (snap) => {
                    const data = snap.docs.map(d => ({ id: d.id, ...d.data() }));
                    if (data.length > 0) setGalleryList(data);
                });

                // 5. Fetch Facilities
                const unsubFacilities = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'facilities'), (snap) => {
                    const data = snap.docs.map(d => ({ id: d.id, ...d.data() }));
                    if (data.length > 0) setFacilitiesList(data);
                });

                return () => {
                    unsubTeachers();
                    unsubStudents();
                    unsubNews();
                    unsubGallery();
                    unsubFacilities();
                };
            }, [user]);


            // EFFECT BARU: Mengambil data PPDB dari Firestore secara Realtime
            useEffect(() => {
                if ((activeTab === "Data PPDB" || activeTab === "Admin") && user) {
                    try {
                        const q = query(
                            collection(db, 'artifacts', appId, 'public', 'data', 'ppdb_registrations'), 
                            orderBy('createdAt', 'desc')
                        );
                        
                        const unsubscribe = onSnapshot(q, (snapshot) => {
                            const submissions = snapshot.docs.map(doc => ({
                                id: doc.id,
                                ...doc.data()
                            }));
                            setPpdbSubmissions(submissions);
                        }, (error) => {
                            console.error("Error fetching data:", error);
                        });

                        return () => unsubscribe();
                    } catch (err) {
                        console.error("Setup listener failed", err);
                    }
                }
            }, [activeTab, user]);

            const handleLogin = (e) => {
                e.preventDefault();
                if (loginPassword === "123456") {
                    setIsAdmin(true);
                    setShowLoginModal(false);
                    setActiveTab("Admin");
                    setLoginPassword("");
                } else {
                    alert("Password Salah!");
                }
            };

            const handleMigration = async () => {
                if (!auth.currentUser) {
                    alert("Koneksi database belum siap. Silakan tunggu sebentar atau refresh halaman.");
                    return;
                }

                if (!confirm("Apakah Anda yakin ingin memigrasikan data bawaan ke Firebase? Ini mungkin membuat duplikat jika data sudah ada.")) return;
                setMigrationLoading(true);
                
                try {
                    // 1. Migrate Teachers
                    await Promise.all(initialTeacherData.map(t => addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'teachers'), t)));
                    
                    // 2. Migrate Students (Flatten)
                    let allStudents = [];
                    // Menggunakan data lengkap dari initialStudentData (termasuk yang disingkat di kode sebelumnya jika ada)
                    // Disini saya akan menggunakan loop untuk memastikan structure
                    Object.keys(initialStudentData).forEach(cls => {
                        initialStudentData[cls].forEach(s => allStudents.push({ ...s, className: cls }));
                    });
                    await Promise.all(allStudents.map(s => addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'students'), s)));
                    
                    // 3. Migrate News
                    await Promise.all(initialNewsData.map(n => addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'news'), n)));
                    
                    // 4. Migrate Gallery
                    await Promise.all(initialGalleryData.map(g => addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'gallery'), g)));

                    // 5. Migrate Facilities
                    await Promise.all(initialFacilities.map(f => addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'facilities'), f)));

                    // 6. Migrate Stats
                    await Promise.all(initialStatsData.map(s => addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'stats'), s)));

                    alert("Migrasi Data Berhasil! Aplikasi sekarang menggunakan data dari Database.");
                } catch (e) {
                    console.error("Migration Error:", e);
                    if (e.code === 'permission-denied') {
                        alert("Gagal migrasi: Izin ditolak (Permission Denied). \n\nJika Anda menggunakan project Firebase sendiri, pastikan 'Firestore Security Rules' diatur ke 'allow read, write: if true;' (untuk mode test) atau izinkan auth user.");
                    } else {
                        alert("Gagal migrasi: " + e.message);
                    }
                }
                setMigrationLoading(false);
            };

            const handlePpdbChange = (e) => {
                const { name, value } = e.target;
                setPpdbData(prev => ({...prev, [name]: value}));
            };

            const handlePpdbSubmit = async (e) => {
                e.preventDefault();
                if (!auth.currentUser) return;
                setIsSubmitting(true);

                try {
                    await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'ppdb_registrations'), {
                        ...ppdbData,
                        createdAt: serverTimestamp()
                    });

                    // Reset form and show success
                    const successMessage = document.createElement('div');
                    successMessage.className = "fixed top-4 right-4 bg-green-500 text-white px-6 py-4 rounded shadow-lg z-50 animate-fade-in";
                    successMessage.innerHTML = `
                        <div class="flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                            <div>
                                <strong>Pendaftaran Berhasil!</strong><br/>
                                Terima kasih, ${ppdbData.nama}. Data Anda telah tersimpan di database.
                            </div>
                        </div>
                    `;
                    document.body.appendChild(successMessage);
                    setTimeout(() => {
                        successMessage.remove();
                    }, 5000);

                    setShowPPDBForm(false);
                    // Pindah ke tab Data PPDB agar user bisa melihat datanya
                    setActiveTab("Data PPDB");
                    
                    setPpdbData({
                        nama: "",
                        nik: "",
                        tempatLahir: "",
                        tanggalLahir: "",
                        jenisKelamin: "L",
                        namaOrtu: "",
                        noHp: "",
                        alamat: ""
                    });
                } catch (error) {
                    console.error("Error adding document: ", error);
                    alert("Terjadi kesalahan saat menyimpan data. Silakan coba lagi.");
                }
                setIsSubmitting(false);
            };

            // FUNGSI BARU: Menyiapkan penghapusan
            const confirmDelete = (id, collectionName) => {
                setItemToDelete(id);
                setCollectionToDelete(collectionName);
                setDeleteModalOpen(true);
            };

            // FUNGSI BARU: Eksekusi penghapusan data
            const executeDelete = async () => {
                if (itemToDelete && collectionToDelete) {
                    try {
                        await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', collectionToDelete, itemToDelete));
                        setDeleteModalOpen(false);
                        setItemToDelete(null);
                        setCollectionToDelete(null);
                        
                        // Show success message
                        const successMessage = document.createElement('div');
                        successMessage.className = "fixed top-4 right-4 bg-red-500 text-white px-6 py-4 rounded shadow-lg z-50 animate-fade-in";
                        successMessage.innerHTML = `
                            <div class="flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                                <div>
                                    <strong>Data Dihapus!</strong><br/>
                                    Data berhasil dihapus dari database.
                                </div>
                            </div>
                        `;
                        document.body.appendChild(successMessage);
                        setTimeout(() => {
                            successMessage.remove();
                        }, 3000);
                    } catch (error) {
                        console.error("Error deleting document: ", error);
                        alert("Gagal menghapus data: " + error.message);
                    }
                }
            };

            const renderContent = () => {
                switch(activeTab) {
                    case "Profil":
                        return (
                            <div className="space-y-12 animate-fade-in">
                                {/* Karakteristik */}
                                <div className="bg-white p-8 rounded-xl shadow-sm border-l-4 border-red-600">
                                    <h3 className="text-2xl font-bold text-red-900 mb-4 flex items-center gap-2">
                                        <Icon name="school" className="w-6 h-6" /> Karakteristik Sekolah
                                    </h3>
                                    <div className="text-gray-700 leading-relaxed mb-4 space-y-3">
                                        <p>
                                            SD Negeri 0207 Pangirkiran beralamat di Desa Pangirkiran Dolok, Kecamatan Barumun Tengah, Kabupaten Padang Lawas. 
                                            Secara geografis, sekolah ini terletak di daerah dataran tinggi yang sejuk.
                                        </p>
                                        <p>
                                            Tenaga Pendidik di sekolah ini alumni sarjana dari Perguruan tinggi dan sudah tersertifikasi. 
                                            Siswa di SD Negeri 0207 Pangirkiran berasal dari Desa Pangirkiran Dolok dan Desa Janji Raja yang berjumlah kurang lebih 117 orang.
                                        </p>
                                        <p>
                                            Kegiatan KBM berlangsung selama 6 (enam) Hari senin sampai dengan Sabtu, dan memiliki kegiatan Ekstrakurikuler Pramuka, Seni, dan Olah Raga.
                                            Sekolah ini berstatus negeri dengan NPSN 10207504. Berdiri sejak tahun 1977 dan memiliki akreditasi C.
                                        </p>
                                        <p className="bg-red-50 p-3 rounded-lg border border-red-100">
                                            <strong className="text-red-800 block mb-1">Kurikulum Merdeka</strong>
                                            SD Negeri 0207 Pangirkiran menerapkan Kurikulum Merdeka yang berfokus pada pengembangan karakter Profil Pelajar Pancasila.
                                        </p>
                                    </div>
                                    <div className="grid md:grid-cols-2 gap-4 text-sm text-gray-600 bg-gray-50 p-4 rounded-lg">
                                        <div className="flex items-center gap-2"><Icon name="map-pin" className="w-4 h-4 text-red-500" /> Desa Pangirkiran Dolok & Desa Janji Raja</div>
                                        <div className="flex items-center gap-2"><Icon name="users" className="w-4 h-4 text-red-500" /> 117 Siswa</div>
                                        <div className="flex items-center gap-2"><Icon name="clock" className="w-4 h-4 text-red-500" /> KBM Senin - Sabtu</div>
                                        <div className="flex items-center gap-2"><Icon name="book-open" className="w-4 h-4 text-red-500" /> Kurikulum Merdeka</div>
                                        <div className="flex items-center gap-2 md:col-span-2"><Icon name="award" className="w-4 h-4 text-red-500" /> Akreditasi C (NPSN: 10207504)  Est. 1977</div>
                                    </div>
                                </div>
                                
                                {/* Visi Misi */}
                                <div className="grid md:grid-cols-2 gap-8">
                                    <div className="bg-red-900 text-white p-8 rounded-xl shadow-lg">
                                        <h3 className="text-xl font-bold mb-4 border-b border-red-700 pb-2">Visi Sekolah</h3>
                                        <p className="italic text-lg text-center leading-relaxed">
                                            "Terwujudnya Peserta Didik Yang Akhlak Mulia Berilmu Berprestasi Dan Berwawasan Global"
                                        </p>
                                    </div>
                                    <div className="bg-white p-8 rounded-xl shadow-sm border border-gray-200">
                                        <h3 className="text-xl font-bold mb-4 text-red-900 border-b pb-2">Misi Sekolah</h3>
                                        <ol className="list-decimal list-inside space-y-3 text-gray-700">
                                            <li>Menanamkan keimanan dan ketakwaan melalui pengamalan ajaran agama.</li>
                                            <li>Mengoptimalkan proses belajar dan bimbingan.</li>
                                            <li>Mengembangkan minat bakat dan potensi Peserta Didik.</li>
                                            <li>Menjalin Kerjasama yang Harmonis Antar warga Sekolah dan Lembaga Lain yang Terkait.</li>
                                        </ol>
                                    </div>
                                </div>

                                {/* Statistik */}
                                <div className="bg-white p-8 rounded-xl shadow-sm">
                                    <h3 className="text-xl font-bold mb-6 text-gray-800 text-center">Statistik Penerimaan Siswa (5 Tahun Terakhir)</h3>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-sm text-left text-gray-500">
                                            <thead className="text-xs text-gray-700 uppercase bg-gray-100">
                                                <tr>
                                                    <th className="px-6 py-3">Tahun Ajaran</th>
                                                    <th className="px-6 py-3 text-center">Laki-laki</th>
                                                    <th className="px-6 py-3 text-center">Perempuan</th>
                                                    <th className="px-6 py-3 text-center">Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {stats.map((stat, idx) => (
                                                    <tr key={idx} className="bg-white border-b hover:bg-gray-50">
                                                        <td className="px-6 py-4 font-medium text-gray-900">{stat.year}</td>
                                                        <td className="px-6 py-4 text-center text-red-600 font-bold">{stat.L}</td>
                                                        <td className="px-6 py-4 text-center text-pink-600 font-bold">{stat.P}</td>
                                                        <td className="px-6 py-4 text-center font-bold">{stat.L + stat.P}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        );
                    case "Profil GTK":
                        return (
                            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 animate-fade-in">
                                {teachers.map((teacher, idx) => (
                                    <div 
                                        key={idx} 
                                        onClick={() => setSelectedTeacher(teacher)}
                                        className="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-xl transition-all cursor-pointer group border border-gray-100 relative"
                                    >
                                        {/* Admin Delete Button */}
                                        {isAdmin && teacher.id && (
                                            <button 
                                                onClick={(e) => { e.stopPropagation(); confirmDelete(teacher.id, 'teachers'); }}
                                                className="absolute top-2 right-2 z-10 bg-red-600 text-white p-1 rounded-full shadow-md hover:bg-red-800"
                                                title="Hapus Guru"
                                            >
                                                <Icon name="trash" className="w-4 h-4" />
                                            </button>
                                        )}
                                        <div className="aspect-[3/4] w-full bg-gray-200 relative overflow-hidden">
                                            <img 
                                                src={teacher.image || `https://ui-avatars.com/api/?name=${teacher.name}&background=random&size=256`} 
                                                alt={teacher.name} 
                                                onError={(e) => {
                                                    e.target.onerror = null; 
                                                    e.target.src = `https://ui-avatars.com/api/?name=${teacher.name}&background=random&size=256`;
                                                }}
                                                className="w-full h-full object-cover object-center group-hover:scale-105 transition-transform duration-500"
                                            />
                                            <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-center pb-4">
                                                <span className="text-white font-bold px-4 py-1 bg-red-600 rounded-full text-sm shadow-lg transform translate-y-4 group-hover:translate-y-0 transition-transform">Lihat Profil</span>
                                            </div>
                                        </div>
                                        <div className="p-4 text-center">
                                            <h4 className="font-bold text-gray-800 text-sm md:text-base line-clamp-1">{teacher.name}</h4>
                                            <p className="text-xs text-red-600 mt-1 font-semibold">{teacher.role}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        );
                    case "Siswa":
                        return (
                            <div className="grid md:grid-cols-3 gap-6 animate-fade-in">
                                <div className="md:col-span-1 space-y-2">
                                    <h3 className="font-bold text-gray-700 mb-4 px-2">Pilih Kelas</h3>
                                    {Object.keys(students).map(cls => (
                                        <button 
                                            key={cls}
                                            onClick={() => setSelectedClass(cls)}
                                            className={`w-full text-left px-4 py-3 rounded-lg flex justify-between items-center transition-all ${selectedClass === cls ? 'bg-red-600 text-white shadow-md' : 'bg-white hover:bg-gray-100 text-gray-700'}`}
                                        >
                                            <span>{cls}</span>
                                            <span className={`text-xs px-2 py-1 rounded-full ${selectedClass === cls ? 'bg-white text-red-600' : 'bg-gray-200 text-gray-600'}`}>
                                                {students[cls] ? students[cls].length : 0} Siswa
                                            </span>
                                        </button>
                                    ))}
                                </div>
                                <div className="md:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                    <h3 className="text-xl font-bold text-red-900 mb-6 border-b pb-4 flex items-center gap-2">
                                        <Icon name="users" className="w-5 h-5" /> Daftar Siswa {selectedClass}
                                    </h3>
                                    <div className="overflow-y-auto max-h-[600px]">
                                        <ul className="grid md:grid-cols-2 gap-3">
                                            {students[selectedClass] && students[selectedClass].map((student, idx) => (
                                                <li 
                                                    key={idx} 
                                                    onClick={() => setSelectedStudent(student)}
                                                    className="flex items-center gap-3 p-3 hover:bg-red-50 border border-gray-100 rounded-lg transition-colors cursor-pointer group relative"
                                                >
                                                    {isAdmin && student.id && (
                                                        <button 
                                                            onClick={(e) => { e.stopPropagation(); confirmDelete(student.id, 'students'); }}
                                                            className="absolute top-1 right-1 text-red-400 hover:text-red-700 p-1"
                                                            title="Hapus Siswa"
                                                        >
                                                            <Icon name="trash" className="w-4 h-4" />
                                                        </button>
                                                    )}
                                                    <div className="w-8 h-8 bg-red-100 text-red-600 rounded-full flex items-center justify-center text-xs font-bold group-hover:bg-red-600 group-hover:text-white transition-colors">
                                                        {idx + 1}
                                                    </div>
                                                    <span className="text-sm font-medium text-gray-700">{student.name}</span>
                                                </li>
                                            ))}
                                            {(!students[selectedClass] || students[selectedClass].length === 0) && (
                                                <p className="text-gray-500 italic text-sm p-4 text-center col-span-2">Belum ada data siswa untuk kelas ini.</p>
                                            )}
                                        </ul>
                                    </div>
                                    <p className="text-xs text-gray-400 mt-4 italic">* Klik nama siswa untuk melihat detail lengkap.</p>
                                </div>
                            </div>
                        );
                    case "Akademik":
                        return (
                            <div className="space-y-12 animate-fade-in">
                                {/* Roster */}
                                <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                    <div className="flex flex-col md:flex-row justify-between items-center mb-6">
                                        <h3 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                                            <Icon name="calendar-days" className="w-6 h-6 text-red-600" /> Jadwal Pelajaran
                                        </h3>
                                        <select 
                                            value={activeRosterClass} 
                                            onChange={(e) => setActiveRosterClass(e.target.value)}
                                            className="mt-4 md:mt-0 px-4 py-2 border rounded-lg bg-gray-50 focus:ring-2 focus:ring-red-500 outline-none"
                                        >
                                            {Object.keys(rosterData).map(k => <option key={k} value={k}>{k}</option>)}
                                        </select>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-sm text-center border-collapse">
                                            <thead>
                                                <tr className="bg-red-600 text-white">
                                                    <th className="p-3 border border-red-700">Jam</th>
                                                    <th className="p-3 border border-red-700">Senin</th>
                                                    <th className="p-3 border border-red-700">Selasa</th>
                                                    <th className="p-3 border border-red-700">Rabu</th>
                                                    <th className="p-3 border border-red-700">Kamis</th>
                                                    <th className="p-3 border border-red-700">Jumat</th>
                                                    <th className="p-3 border border-red-700">Sabtu</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {rosterData[activeRosterClass].map((row, idx) => (
                                                    <tr key={idx} className="even:bg-gray-50 hover:bg-red-50">
                                                        <td className="p-3 border text-gray-500 font-bold">{row.jam}</td>
                                                        <td className="p-3 border">{row.sen}</td>
                                                        <td className="p-3 border">{row.sel}</td>
                                                        <td className="p-3 border">{row.rab}</td>
                                                        <td className="p-3 border">{row.kam}</td>
                                                        <td className="p-3 border">{row.jum}</td>
                                                        <td className="p-3 border">{row.sab}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                {/* Calendar */}
                                <div className="grid md:grid-cols-2 gap-8">
                                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                        <h3 className="font-bold text-lg mb-4 text-red-900 border-b pb-2">Kalender 2025</h3>
                                        <ul className="space-y-4">
                                            {calendar2025.map((c, i) => (
                                                <li key={i} className="flex gap-4">
                                                    <div className="w-24 text-right text-xs font-bold text-gray-500 pt-1">{c.date}</div>
                                                    <div className="flex-1 pb-4 border-l-2 border-red-200 pl-4 relative">
                                                        <div className="absolute -left-[5px] top-1.5 w-2 h-2 bg-red-600 rounded-full"></div>
                                                        <p className="text-sm font-medium">{c.event}</p>
                                                    </div>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>
                                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                        <h3 className="font-bold text-lg mb-4 text-green-900 border-b pb-2">Kalender 2026</h3>
                                        <ul className="space-y-4">
                                            {calendar2026.map((c, i) => (
                                                <li key={i} className="flex gap-4">
                                                    <div className="w-24 text-right text-xs font-bold text-gray-500 pt-1">{c.date}</div>
                                                    <div className="flex-1 pb-4 border-l-2 border-green-200 pl-4 relative">
                                                        <div className="absolute -left-[5px] top-1.5 w-2 h-2 bg-green-600 rounded-full"></div>
                                                        <p className="text-sm font-medium">{c.event}</p>
                                                    </div>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        );
                    case "Fasilitas":
                        return (
                            <div className="space-y-12 animate-fade-in">
                                <div>
                                    <h3 className="text-xl font-bold mb-6 text-gray-800">Sarana & Prasarana</h3>
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                        {facilitiesList.map((fac) => (
                                            <div 
                                                key={fac.id}
                                                onClick={() => setSelectedFacility(fac)}
                                                className="bg-white p-6 rounded-xl shadow-sm hover:shadow-lg transition-all cursor-pointer text-center group border border-gray-100"
                                            >
                                                <div className="w-16 h-16 bg-red-50 text-red-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-red-600 group-hover:text-white transition-colors">
                                                    <Icon name="building-2" className="w-8 h-8" />
                                                </div>
                                                <h4 className="font-bold text-gray-800">{fac.name}</h4>
                                                <p className="text-xs text-gray-500 mt-2">Klik untuk foto</p>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                
                                <div>
                                    <h3 className="text-xl font-bold mb-6 text-gray-800">Ekstrakurikuler</h3>
                                    <div className="grid md:grid-cols-3 gap-6">
                                        {initialExtracurriculars.map((ex) => (
                                            <div 
                                                key={ex.id}
                                                onClick={() => setSelectedExtra(ex)}
                                                className="relative group cursor-pointer overflow-hidden rounded-xl shadow-md h-48"
                                            >
                                                <div className="absolute inset-0 bg-gray-800">
                                                    <img src={`https://placehold.co/600x400?text=${ex.name}`} alt={ex.name} className="w-full h-full object-cover opacity-60 group-hover:opacity-40 transition-opacity" />
                                                </div>
                                                <div className="absolute bottom-0 left-0 p-6 text-white">
                                                    <h4 className="text-xl font-bold mb-1">{ex.name}</h4>
                                                    <p className="text-sm opacity-90">{ex.desc}</p>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        );
                    case "Admin":
                        return (
                            <div className="animate-fade-in space-y-8">
                                <div className="bg-white p-8 rounded-xl shadow-md border border-red-200">
                                    <h3 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                        <Icon name="lock" className="w-6 h-6 text-red-600" />
                                        Dashboard Admin
                                    </h3>
                                    <p className="text-gray-600 mb-6">
                                        Selamat datang di panel admin. Anda dapat menggunakan fitur ini untuk memigrasikan data hardcoded (bawaan) ke database Firebase agar data dapat dikelola secara dinamis.
                                    </p>
                                    
                                    <div className="bg-blue-50 p-6 rounded-lg border border-blue-100">
                                        <h4 className="font-bold text-blue-800 mb-2 flex items-center gap-2">
                                            <Icon name="refresh" className="w-5 h-5" />
                                            Migrasi Data Bawaan
                                        </h4>
                                        <p className="text-sm text-blue-600 mb-4">
                                            Klik tombol di bawah ini untuk mengupload semua data Guru, Siswa, Berita, dan Galeri yang ada di kode ke Firestore.
                                            Pastikan koneksi internet stabil.
                                        </p>
                                        <button 
                                            onClick={handleMigration}
                                            disabled={migrationLoading}
                                            className={`flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition-colors shadow-md ${migrationLoading ? 'opacity-70 cursor-not-allowed' : ''}`}
                                        >
                                            {migrationLoading ? (
                                                <>
                                                    <Icon name="refresh" className="w-5 h-5 animate-spin-slow" /> Sedang Memigrasi...
                                                </>
                                            ) : (
                                                <>
                                                    <Icon name="upload" className="w-5 h-5" /> Migrasi Semua Data ke Firebase
                                                </>
                                            )}
                                        </button>
                                    </div>
                                </div>

                                {/* Reuse Data PPDB view for admin */}
                                <div className="bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden">
                                    <div className="p-6 border-b border-gray-100">
                                        <h3 className="text-xl font-bold text-gray-800">Manajemen Pendaftar PPDB</h3>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-sm text-left">
                                            <thead className="bg-gray-50 text-gray-700 uppercase font-bold border-b">
                                                <tr>
                                                    <th className="px-6 py-3">No</th>
                                                    <th className="px-6 py-3">Nama</th>
                                                    <th className="px-6 py-3">NIK</th>
                                                    <th className="px-6 py-3">Ortu</th>
                                                    <th className="px-6 py-3">HP</th>
                                                    <th className="px-6 py-3 text-center">Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {ppdbSubmissions.length === 0 ? (
                                                    <tr><td colSpan="6" className="p-6 text-center text-gray-500">Belum ada data.</td></tr>
                                                ) : ppdbSubmissions.map((data, idx) => (
                                                    <tr key={data.id} className="border-b hover:bg-gray-50">
                                                        <td className="px-6 py-4">{idx + 1}</td>
                                                        <td className="px-6 py-4 font-bold">{data.nama}</td>
                                                        <td className="px-6 py-4">{data.nik}</td>
                                                        <td className="px-6 py-4">{data.namaOrtu}</td>
                                                        <td className="px-6 py-4">{data.noHp}</td>
                                                        <td className="px-6 py-4 text-center">
                                                            <button onClick={() => confirmDelete(data.id, 'ppdb_registrations')} className="text-red-600 hover:bg-red-50 p-2 rounded"><Icon name="trash" className="w-5 h-5" /></button>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        );
                    case "Data PPDB":
                        return (
                            <div className="space-y-8 animate-fade-in">
                                <div className="text-center">
                                    <h3 className="text-2xl font-bold text-gray-800">Data Pendaftar PPDB</h3>
                                    <p className="text-gray-600">Data berikut diambil langsung dari database sekolah.</p>
                                </div>

                                <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-sm text-left">
                                            <thead className="bg-gray-50 text-gray-700 uppercase font-bold border-b">
                                                <tr>
                                                    <th className="px-6 py-3">No</th>
                                                    <th className="px-6 py-3">Nama Siswa</th>
                                                    <th className="px-6 py-3">L/P</th>
                                                    <th className="px-6 py-3">TTL</th>
                                                    <th className="px-6 py-3">Nama Orang Tua</th>
                                                    <th className="px-6 py-3">No. HP</th>
                                                    <th className="px-6 py-3">Waktu Daftar</th>
                                                    <th className="px-6 py-3 text-center">Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-gray-100">
                                                {ppdbSubmissions.length === 0 ? (
                                                    <tr>
                                                        <td colSpan="8" className="px-6 py-8 text-center text-gray-500 italic">
                                                            Belum ada data pendaftar. Silakan isi formulir di menu PPDB.
                                                        </td>
                                                    </tr>
                                                ) : (
                                                    ppdbSubmissions.map((data, idx) => (
                                                        <tr key={data.id} className="hover:bg-gray-50 transition-colors">
                                                            <td className="px-6 py-4 font-medium text-gray-900">{idx + 1}</td>
                                                            <td className="px-6 py-4 font-bold text-gray-800">{data.nama}</td>
                                                            <td className="px-6 py-4">
                                                                <span className={`px-2 py-1 rounded text-xs font-bold ${data.jenisKelamin === 'L' ? 'bg-blue-100 text-blue-700' : 'bg-pink-100 text-pink-700'}`}>
                                                                    {data.jenisKelamin}
                                                                </span>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                {data.tempatLahir}, {data.tanggalLahir}
                                                            </td>
                                                            <td className="px-6 py-4">{data.namaOrtu}</td>
                                                            <td className="px-6 py-4 font-mono text-gray-600">{data.noHp}</td>
                                                            <td className="px-6 py-4 text-xs text-gray-500">
                                                                {data.createdAt ? new Date(data.createdAt.seconds * 1000).toLocaleString('id-ID') : 'Baru saja'}
                                                            </td>
                                                            <td className="px-6 py-4 text-center">
                                                                <button 
                                                                    onClick={() => confirmDelete(data.id, 'ppdb_registrations')}
                                                                    className="text-red-600 hover:text-red-800 hover:bg-red-50 p-2 rounded-full transition-colors"
                                                                    title="Hapus Data"
                                                                >
                                                                    <Icon name="trash" className="w-5 h-5" />
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    ))
                                                )}
                                            </tbody>
                                        </table>
                                    </div>
                                    <div className="bg-gray-50 px-6 py-3 border-t text-xs text-gray-500 flex justify-between items-center">
                                        <span>Total Pendaftar: <strong>{ppdbSubmissions.length}</strong></span>
                                        <span className="italic">Data diperbarui secara otomatis (Realtime)</span>
                                    </div>
                                </div>
                            </div>
                        );
                    case "PPDB":
                        if (showPPDBForm) {
                            return (
                                <div className="max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg animate-fade-in border border-gray-200">
                                    <div className="flex items-center gap-3 mb-6 border-b pb-4">
                                        <button onClick={() => setShowPPDBForm(false)} className="text-gray-500 hover:text-red-600">
                                            <Icon name="x" className="w-6 h-6" />
                                        </button>
                                        <h3 className="text-2xl font-bold text-gray-800">Formulir Pendaftaran</h3>
                                    </div>
                                    
                                    <form onSubmit={handlePpdbSubmit} className="space-y-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap Calon Siswa</label>
                                            <input type="text" name="nama" required value={ppdbData.nama} onChange={handlePpdbChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none" placeholder="Sesuai Akta Kelahiran" />
                                        </div>
                                        
                                        <div className="grid md:grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">NIK</label>
                                                <input type="number" name="nik" required value={ppdbData.nik} onChange={handlePpdbChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none" placeholder="Nomor Induk Kependudukan" />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Jenis Kelamin</label>
                                                <select name="jenisKelamin" value={ppdbData.jenisKelamin} onChange={handlePpdbChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none">
                                                    <option value="L">Laki-laki</option>
                                                    <option value="P">Perempuan</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div className="grid md:grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Tempat Lahir</label>
                                                <input type="text" name="tempatLahir" required value={ppdbData.tempatLahir} onChange={handlePpdbChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none" />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Tanggal Lahir</label>
                                                <input type="date" name="tanggalLahir" required value={ppdbData.tanggalLahir} onChange={handlePpdbChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none" />
                                            </div>
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Nama Orang Tua / Wali</label>
                                            <input type="text" name="namaOrtu" required value={ppdbData.namaOrtu} onChange={handlePpdbChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none" />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Nomor HP / WhatsApp</label>
                                            <input type="tel" name="noHp" required value={ppdbData.noHp} onChange={handlePpdbChange} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none" placeholder="Contoh: 081234567890" />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Alamat Lengkap</label>
                                            <textarea name="alamat" required value={ppdbData.alamat} onChange={handlePpdbChange} rows="3" className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none"></textarea>
                                        </div>

                                        <div className="pt-4 flex gap-3">
                                            <button type="button" onClick={() => setShowPPDBForm(false)} className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold transition-colors">Batal</button>
                                            <button 
                                                type="submit" 
                                                disabled={isSubmitting}
                                                className={`flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold transition-colors shadow-md ${isSubmitting ? 'opacity-70 cursor-not-allowed' : ''}`}
                                            >
                                                {isSubmitting ? 'Sedang Mengirim...' : 'Kirim Pendaftaran'}
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            );
                        }
                        return (
                            <div className="space-y-8 animate-fade-in">
                                <div className="bg-red-50 border-l-4 border-red-600 p-6 rounded-r-lg shadow-sm">
                                    <h3 className="text-2xl font-bold text-red-900 mb-2 flex items-center gap-2">
                                        <Icon name="file-text" className="w-6 h-6" />
                                        Penerimaan Peserta Didik Baru (PPDB)
                                    </h3>
                                    <p className="text-gray-700 mt-2">
                                        SD Negeri 0207 Pangirkiran membuka kesempatan bagi putra-putri Bapak/Ibu untuk bergabung menjadi bagian dari keluarga besar kami.
                                        Mari wujudkan generasi cerdas dan berakhlak mulia bersama kami.
                                    </p>
                                    <div className="mt-4 flex gap-3">
                                        <button 
                                            onClick={() => setShowPPDBForm(true)}
                                            className="bg-red-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-red-700 transition-colors shadow"
                                        >
                                            Daftar Sekarang
                                        </button>
                                        <button className="bg-white text-red-600 border border-red-600 px-6 py-2 rounded-lg font-semibold hover:bg-red-50 transition-colors">
                                            Download Brosur
                                        </button>
                                    </div>
                                </div>

                                <div className="grid md:grid-cols-2 gap-8">
                                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                        <h4 className="font-bold text-lg mb-4 text-gray-800 border-b pb-2">Persyaratan Pendaftaran</h4>
                                        <ul className="space-y-3 text-gray-700">
                                            <li className="flex items-start gap-2">
                                                <Icon name="check-circle" className="w-5 h-5 text-green-500 mt-0.5" />
                                                <span>Mengisi Formulir Pendaftaran</span>
                                            </li>
                                            <li className="flex items-start gap-2">
                                                <Icon name="check-circle" className="w-5 h-5 text-green-500 mt-0.5" />
                                                <span>Fotokopi Akta Kelahiran (2 Lembar)</span>
                                            </li>
                                            <li className="flex items-start gap-2">
                                                <Icon name="check-circle" className="w-5 h-5 text-green-500 mt-0.5" />
                                                <span>Fotokopi Kartu Keluarga (2 Lembar)</span>
                                            </li>
                                            <li className="flex items-start gap-2">
                                                <Icon name="check-circle" className="w-5 h-5 text-green-500 mt-0.5" />
                                                <span>Fotokopi KTP Orang Tua (Ayah & Ibu)</span>
                                            </li>
                                            <li className="flex items-start gap-2">
                                                <Icon name="check-circle" className="w-5 h-5 text-green-500 mt-0.5" />
                                                <span>Pas Foto 3x4 (2 Lembar)</span>
                                            </li>
                                            <li className="flex items-start gap-2">
                                                <Icon name="check-circle" className="w-5 h-5 text-green-500 mt-0.5" />
                                                <span>Ijazah TK/PAUD (Jika Ada)</span>
                                            </li>
                                        </ul>
                                    </div>

                                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                        <h4 className="font-bold text-lg mb-4 text-gray-800 border-b pb-2">Alur & Jadwal</h4>
                                        <div className="space-y-4">
                                            <div className="flex gap-4">
                                                <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-red-600 font-bold flex-shrink-0">1</div>
                                                <div>
                                                    <h5 className="font-bold text-gray-800">Pengambilan Formulir</h5>
                                                    <p className="text-sm text-gray-600">1 - 30 Mei 2026 (Di Sekolah)</p>
                                                </div>
                                            </div>
                                            <div className="flex gap-4">
                                                <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-red-600 font-bold flex-shrink-0">2</div>
                                                <div>
                                                    <h5 className="font-bold text-gray-800">Pengembalian Berkas</h5>
                                                    <p className="text-sm text-gray-600">2 - 10 Juni 2026</p>
                                                </div>
                                            </div>
                                            <div className="flex gap-4">
                                                <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-red-600 font-bold flex-shrink-0">3</div>
                                                <div>
                                                    <h5 className="font-bold text-gray-800">Seleksi Administrasi</h5>
                                                    <p className="text-sm text-gray-600">11 - 15 Juni 2026</p>
                                                </div>
                                            </div>
                                            <div className="flex gap-4">
                                                <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-red-600 font-bold flex-shrink-0">4</div>
                                                <div>
                                                    <h5 className="font-bold text-gray-800">Pengumuman Diterima</h5>
                                                    <p className="text-sm text-gray-600">20 Juni 2026</p>
                                                </div>
                                            </div>
                                            {/* Menambahkan jadwal Hari Pertama Sekolah */}
                                            <div className="flex gap-4">
                                                <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-red-600 font-bold flex-shrink-0">5</div>
                                                <div>
                                                    <h5 className="font-bold text-gray-800">Hari Pertama Sekolah</h5>
                                                    <p className="text-sm text-gray-600">13 Juli 2026</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="bg-gray-50 p-6 rounded-xl text-center">
                                    <h4 className="font-bold text-lg mb-2">Butuh Informasi Lebih Lanjut?</h4>
                                    <p className="text-gray-600 mb-4">Silakan hubungi panitia PPDB kami melalui kontak berikut:</p>
                                    <div className="flex justify-center gap-4 flex-wrap">
                                        <a href="#" className="flex items-center gap-2 bg-white px-4 py-2 rounded-full shadow-sm text-gray-700 hover:text-red-600">
                                            <Icon name="phone" className="w-4 h-4" /> Ibu Guru A (0812-xxxx-xxxx)
                                        </a>
                                        <a href="#" className="flex items-center gap-2 bg-white px-4 py-2 rounded-full shadow-sm text-gray-700 hover:text-red-600">
                                            <Icon name="phone" className="w-4 h-4" /> Bapak Guru B (0813-xxxx-xxxx)
                                        </a>
                                    </div>
                                </div>
                            </div>
                        );
                    case "Galeri":
                        return (
                            <div className="animate-fade-in space-y-6">
                                <div className="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3">
                                    {galleryList.map(item => (
                                        <div 
                                            key={item.id} 
                                            className="group relative cursor-pointer overflow-hidden rounded-xl shadow-md aspect-square bg-gray-100"
                                            onClick={() => setSelectedGalleryImage(item)}
                                        >
                                            <img 
                                                src={item.image} 
                                                alt={item.title} 
                                                className="h-full w-full object-cover transition-transform duration-300 group-hover:scale-110"
                                            />
                                            <div className="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-2">
                                                <span className="text-[10px] text-red-200 font-semibold mb-0.5 uppercase tracking-wider">{item.category}</span>
                                                <h4 className="text-white font-bold text-xs leading-tight line-clamp-2">{item.title}</h4>
                                                <div className="absolute top-2 right-2 bg-black/50 text-white text-[10px] px-1.5 py-0.5 rounded-full flex items-center gap-1">
                                                    <Icon name="image" className="w-3 h-3" />
                                                    {item.images ? item.images.length : 1}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        );
                    case "Berita & Pengumuman":
                        return (
                            <div className="animate-fade-in space-y-6">
                                <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {newsList.map(news => (
                                        <NewsCard key={news.id} news={news} onClick={setSelectedNews} />
                                    ))}
                                </div>
                            </div>
                        );
                }
            };

            return (
                <div className="min-h-screen flex flex-col hero-pattern">
                    {/* Header */}
                    <nav className="bg-white shadow-md sticky top-0 z-40 border-b border-gray-200">
                        <div className="container mx-auto px-4">
                            <div className="flex justify-between items-center h-20">
                                <div className="flex items-center gap-3">
                                    <img src="logo-padang-lawas.jpg" onError={(e) => e.target.style.display='none'} className="h-10 w-auto" alt="Logo Palas"/>
                                    <div className="leading-tight">
                                        <h1 className="text-lg md:text-xl font-bold text-gray-900 tracking-tight">SD NEGERI 0207</h1>
                                        <p className="text-xs text-red-600 font-semibold tracking-wider">PANGIRKIRAN</p>
                                    </div>
                                </div>
                                <div className="hidden lg:flex gap-6">
                                    {["Profil", "Profil GTK", "Siswa", "Akademik", "PPDB", "Data PPDB", "Galeri", "Berita & Pengumuman", "Fasilitas", ...(isAdmin ? ["Admin"] : [])].map((menu) => (
                                        <button 
                                            key={menu} 
                                            onClick={() => setActiveTab(menu)}
                                            className={`text-sm font-medium transition-colors border-b-2 py-1 ${activeTab === menu ? 'border-red-600 text-red-600' : 'border-transparent text-gray-500 hover:text-gray-900'}`}
                                        >
                                            {menu === "Berita & Pengumuman" ? "Berita" : menu}
                                        </button>
                                    ))}
                                </div>
                                {/* Mobile Menu Button would go here */}
                                <div className="lg:hidden">
                                     <button className="text-gray-600"><Icon name="menu" className="w-6 h-6" /></button>
                                </div>
                            </div>
                            {/* Mobile menu list could go here */}
                            <div className="lg:hidden flex overflow-x-auto gap-4 py-2 scrollbar-hide">
                                {["Profil", "Profil GTK", "Siswa", "Akademik", "PPDB", "Data PPDB", "Galeri", "Berita & Pengumuman", "Fasilitas", ...(isAdmin ? ["Admin"] : [])].map((menu) => (
                                    <button 
                                        key={menu} 
                                        onClick={() => setActiveTab(menu)}
                                        className={`whitespace-nowrap px-3 py-1 rounded-full text-xs font-bold ${activeTab === menu ? 'bg-red-600 text-white' : 'bg-gray-100 text-gray-600'}`}
                                    >
                                        {menu}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </nav>

                    {/* Banner Hero */}
                    {activeTab === "Profil" && (
                        <div className="relative h-[400px] w-full bg-gray-900 flex items-center justify-center overflow-hidden">
                            <img 
                                src="banner-sekolah.jpg" 
                                onError={(e) => {
                                    e.target.onerror = null; 
                                    e.target.src = "https://placehold.co/1200x400/1e3a8a/ffffff?text=SD+Negeri+0207+Pangirkiran";
                                }}
                                className="absolute inset-0 w-full h-full object-cover opacity-90" 
                                alt="Sekolah"
                            />
                            {/* PERBAIKAN: Layer merah transparan halus tipis */}
                            <div className="absolute inset-0 bg-gradient-to-t from-red-900/60 via-red-500/10 to-transparent"></div>
                            
                            <div className="relative z-10 container mx-auto px-4 text-center text-white h-full flex flex-col justify-center">
                                
                                {/* Logos for Desktop (Absolute Positioning) */}
                                <img src="logo-padang-lawas.jpg" onError={(e) => e.target.style.display='none'} className="hidden md:block absolute left-8 top-1/2 -translate-y-1/2 h-40 w-auto drop-shadow-lg bg-white rounded-full p-2 transition-transform hover:scale-110" alt="Logo Padang Lawas" />
                                <img src="logo-tutwuri.png" onError={(e) => e.target.style.display='none'} className="hidden md:block absolute right-8 top-1/2 -translate-y-1/2 h-40 w-auto drop-shadow-lg bg-white rounded-full p-2 transition-transform hover:scale-110" alt="Logo Tutwuri" />

                                {/* Logos for Mobile (Flex) */}
                                <div className="md:hidden flex justify-center items-center gap-6 mb-8">
                                    <img src="logo-padang-lawas.jpg" onError={(e) => e.target.style.display='none'} className="h-24 w-auto drop-shadow-lg bg-white rounded-full p-1" alt="Logo Padang Lawas" />
                                    <img src="logo-tutwuri.png" onError={(e) => e.target.style.display='none'} className="h-24 w-auto drop-shadow-lg bg-white rounded-full p-1" alt="Logo Tutwuri" />
                                </div>

                                <div className="md:px-32">
                                    <h2 className="text-3xl md:text-5xl font-bold mb-4 drop-shadow-md tracking-wide">SD NEGERI 0207 PANGIRKIRAN</h2>
                                    <p className="text-lg md:text-xl text-gray-200 max-w-3xl mx-auto italic font-light">"Terwujudnya Peserta Didik Yang Akhlak Mulia Berilmu Berprestasi Dan Berwawasan Global"</p>
                                </div>
                                
                                <div className="mt-8 flex gap-3 justify-center">
                                    <a href="#sambutan" className="px-6 py-2 bg-red-600 hover:bg-red-700 rounded-full font-semibold transition-all shadow-lg hover:shadow-xl">Sambutan Kepala Sekolah</a>
                                    <a href="#kontak" className="px-6 py-2 bg-white text-gray-900 hover:bg-gray-100 rounded-full font-semibold transition-all shadow-lg hover:shadow-xl">Hubungi Kami</a>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Main Content */}
                    <main className="container mx-auto px-4 py-12 flex-grow">
                        {/* Sambutan (Only on Profil tab) */}
                        {activeTab === "Profil" && (
                            <section id="sambutan" className="mb-16 scroll-mt-24">
                                <div className="bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col md:flex-row">
                                    <div className="md:w-1/3 bg-red-50 relative h-[500px] md:h-auto">
                                        <img 
                                            src="nuraini.jpg" 
                                            onError={(e) => {
                                                e.target.onerror = null; 
                                                e.target.src = "https://placehold.co/400x500/e2e8f0/1e293b?text=Foto+Kepsek";
                                            }}
                                            className="absolute inset-0 w-full h-full object-cover object-top" 
                                            alt="Kepala Sekolah"
                                        />
                                        <div className="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-red-900 to-transparent p-6 pt-20">
                                            <h3 className="text-white font-bold text-xl">Nuraini Nasution, S.Pd.I</h3>
                                            <p className="text-red-200 text-sm">Kepala Sekolah</p>
                                        </div>
                                    </div>
                                    <div className="md:w-2/3 p-8 md:p-12">
                                        <h2 className="text-3xl font-bold text-gray-800 mb-6 relative inline-block">
                                            Sambutan Kepala Sekolah
                                            <span className="absolute bottom-0 left-0 w-1/2 h-1 bg-red-600 rounded-full"></span>
                                        </h2>
                                        <div className="space-y-4 text-gray-600 leading-relaxed text-justify">
                                            <p className="font-semibold text-gray-800">Assalamu'alaikum Warahmatullahi Wabarakatuh,</p>
                                            <p>
                                                Puji syukur kita panjatkan kehadirat Allah SWT atas segala limpahan rahmat dan karunia-Nya, sehingga kita masih diberi kesempatan untuk terus berkarya dalam dunia pendidikan. 
                                                Selamat datang di Website Resmi SD Negeri 0207 Pangirkiran. Website ini kami hadirkan sebagai media informasi dan komunikasi antara sekolah, orang tua, siswa, dan masyarakat luas.
                                            </p>
                                            <p>
                                                Di era digitalisasi saat ini, keterbukaan informasi menjadi hal yang sangat penting. Melalui website ini, kami berupaya memberikan gambaran utuh mengenai profil sekolah, visi dan misi, kegiatan kesiswaan, serta berbagai prestasi yang telah diraih. 
                                                Kami berkomitmen untuk mencetak generasi penerus bangsa yang tidak hanya cerdas secara intelektual, tetapi juga memiliki karakter yang kuat, berakhlak mulia, dan berwawasan global sesuai dengan nilai-nilai Profil Pelajar Pancasila.
                                            </p>
                                            <p>
                                                Kami menyadari bahwa kemajuan sekolah tidak lepas dari dukungan dan kerjasama yang baik dari seluruh pihak. Oleh karena itu, kami mengajak Bapak/Ibu Wali Murid, Komite Sekolah, dan masyarakat sekitar untuk terus bersinergi membangun pendidikan yang berkualitas di SD Negeri 0207 Pangirkiran. 
                                                Mari kita bimbing anak-anak kita untuk menjadi pribadi yang mandiri, kreatif, dan bertaqwa kepada Tuhan Yang Maha Esa.
                                            </p>
                                            <p>
                                                Semoga website ini dapat memberikan manfaat yang seluas-luasnya. Kami juga sangat mengharapkan masukan dan saran yang membangun demi kemajuan sekolah kita tercinta ini di masa mendatang.
                                            </p>
                                            <p className="font-semibold text-gray-800">
                                                Wassalamu'alaikum Warahmatullahi Wabarakatuh.
                                            </p>
                                            <blockquote className="border-l-4 border-red-500 pl-4 italic text-gray-500 my-4 bg-gray-50 p-4 rounded-r-lg">
                                                "Pimpinan yang berkomitmen untuk meningkatkan kualitas pendidikan dan karakter siswa."
                                            </blockquote>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        )}

                        <SectionTitle 
                            title={activeTab} 
                            subtitle={
                                activeTab === "Profil GTK" ? "Mengenal Tenaga Pendidik Profesional Kami" :
                                activeTab === "Siswa" ? "Data Peserta Didik Tahun Ajaran 2025/2026" :
                                activeTab === "Akademik" ? "Jadwal, Kalender Pendidikan & Informasi" :
                                activeTab === "Fasilitas" ? "Sarana Penunjang Kegiatan Belajar Mengajar" :
                                activeTab === "PPDB" ? "Informasi Penerimaan Peserta Didik Baru" :
                                activeTab === "Galeri" ? "Dokumentasi Kegiatan dan Aktivitas Sekolah" :
                                activeTab === "Berita & Pengumuman" ? "Kabar Terbaru & Informasi Penting Sekolah" : 
                                activeTab === "Admin" ? "Area Khusus Administrator Sekolah" : ""
                            } 
                        />

                        {renderContent()}

                        {/* Modals */}
                        <Modal isOpen={selectedTeacher} onClose={() => setSelectedTeacher(null)} title="Profil Pendidik">
                            {selectedTeacher && (
                                <div className="text-center md:text-left md:flex gap-6">
                                    <img 
                                        src={selectedTeacher.image || `https://ui-avatars.com/api/?name=${selectedTeacher.name}&background=random&size=256`} 
                                        onError={(e) => {
                                            e.target.onerror = null; 
                                            e.target.src = `https://ui-avatars.com/api/?name=${selectedTeacher.name}&background=random&size=256`;
                                        }}
                                        className="w-32 h-40 rounded-lg mx-auto md:mx-0 shadow-lg mb-4 md:mb-0 object-cover object-center border-4 border-white" 
                                    />
                                    <div className="space-y-3 flex-1">
                                        <div><span className="text-xs text-gray-500 block uppercase">Nama Lengkap</span><span className="font-bold text-lg">{selectedTeacher.name}</span></div>
                                        <div><span className="text-xs text-gray-500 block uppercase">Jabatan</span><span className="text-red-600 font-medium">{selectedTeacher.role}</span></div>
                                        <div className="grid grid-cols-2 gap-2 mt-4 bg-gray-50 p-3 rounded text-left">
                                            <div><span className="text-xs text-gray-500 block">NIP</span><span className="text-sm font-medium">{selectedTeacher.nip || "-"}</span></div>
                                            <div><span className="text-xs text-gray-500 block">NUPTK</span><span className="text-sm font-medium">{selectedTeacher.nuptk || "-"}</span></div>
                                            <div className="col-span-2"><span className="text-xs text-gray-500 block">Tempat, Tgl Lahir</span><span className="text-sm font-medium">{selectedTeacher.birth || "-"}</span></div>
                                            <div><span className="text-xs text-gray-500 block">Pendidikan</span><span className="text-sm font-medium">{selectedTeacher.education}</span></div>
                                            <div><span className="text-xs text-gray-500 block">Sertifikasi</span><span className="text-sm font-medium">{selectedTeacher.certification || "-"}</span></div>
                                            <div className="col-span-2"><span className="text-xs text-gray-500 block">Universitas/Asal Sekolah</span><span className="text-sm font-medium">{selectedTeacher.university || "-"}</span></div>
                                            <div className="col-span-2"><span className="text-xs text-gray-500 block">Alamat</span><span className="text-sm font-medium">{selectedTeacher.address}</span></div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </Modal>

                        <Modal isOpen={selectedStudent} onClose={() => setSelectedStudent(null)} title="Profil Siswa">
                            {selectedStudent && (
                                <div className="text-center md:text-left md:flex gap-6">
                                    <img 
                                        src={`https://ui-avatars.com/api/?name=${selectedStudent.name}&background=random&size=256&color=fff&background=dc2626`} 
                                        className="w-32 h-32 rounded-full mx-auto md:mx-0 shadow-lg mb-4 md:mb-0" 
                                    />
                                    <div className="space-y-3 flex-1">
                                        <div><span className="text-xs text-gray-500 block uppercase">Nama Lengkap</span><span className="font-bold text-lg">{selectedStudent.name}</span></div>
                                        <div className="grid grid-cols-2 gap-2 mt-4 bg-gray-50 p-3 rounded text-left">
                                            <div><span className="text-xs text-gray-500 block">Jenis Kelamin</span><span className="text-sm font-medium">{selectedStudent.gender || "-"}</span></div>
                                            <div><span className="text-xs text-gray-500 block">NISN</span><span className="text-sm font-medium">{selectedStudent.nisn || "-"}</span></div>
                                            <div className="col-span-2"><span className="text-xs text-gray-500 block">Tempat, Tanggal Lahir</span><span className="text-sm font-medium">{selectedStudent.birth || "-"}</span></div>
                                            <div className="col-span-2"><span className="text-xs text-gray-500 block">Nama Orang Tua</span><span className="text-sm font-medium">{selectedStudent.parent || "-"}</span></div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </Modal>

                        <Modal isOpen={selectedFacility} onClose={() => setSelectedFacility(null)} title="Detail Fasilitas">
                            {selectedFacility && (
                                <div>
                                    <img src={`https://placehold.co/600x400?text=${selectedFacility.name.replace(" ", "+")}`} className="w-full rounded-lg mb-4 shadow-md" alt={selectedFacility.name} />
                                    <p className="text-gray-700">{selectedFacility.desc}</p>
                                </div>
                            )}
                        </Modal>
                        
                        <Modal isOpen={selectedExtra} onClose={() => setSelectedExtra(null)} title="Kegiatan Ekstrakurikuler">
                            {selectedExtra && (
                                <div>
                                    <img src={`https://placehold.co/600x400?text=${selectedExtra.name}`} className="w-full rounded-lg mb-4 shadow-md" alt={selectedExtra.name} />
                                    <p className="text-gray-700">{selectedExtra.desc}</p>
                                    <div className="mt-4 p-4 bg-red-50 rounded-lg text-sm text-red-800">
                                        <Icon name="info" className="inline w-4 h-4 mr-2" />
                                        Jadwal latihan akan diinformasikan oleh pembina masing-masing.
                                    </div>
                                </div>
                            )}
                        </Modal>

                         <Modal isOpen={selectedNews} onClose={() => setSelectedNews(null)} title="Detail Berita">
                            {selectedNews && (
                                <div className="space-y-4">
                                    <img src={selectedNews.image} className="w-full rounded-lg shadow-md h-64 object-cover" alt={selectedNews.title} />
                                    <div className="flex items-center gap-2 text-sm text-gray-500">
                                        <Icon name="calendar-days" className="w-4 h-4" /> {selectedNews.date}
                                        <span className="bg-red-100 text-red-800 text-xs px-2 py-0.5 rounded-full">{selectedNews.category}</span>
                                    </div>
                                    <h4 className="text-xl font-bold text-gray-900">{selectedNews.title}</h4>
                                    <div className="text-gray-700 leading-relaxed whitespace-pre-line">
                                        {selectedNews.content}
                                    </div>
                                </div>
                            )}
                        </Modal>

                        <Modal isOpen={selectedGalleryImage} onClose={() => setSelectedGalleryImage(null)} title="">
                            {selectedGalleryImage && (
                                <div>
                                    <div className="mb-4">
                                        <h4 className="font-bold text-xl text-center text-gray-800">{selectedGalleryImage.title}</h4>
                                        <p className="text-center text-gray-500 text-sm mb-4">{selectedGalleryImage.category}</p>
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar">
                                            {(selectedGalleryImage.images || [selectedGalleryImage.image]).map((img, index) => (
                                                <div key={index} className="relative rounded-lg overflow-hidden shadow-md bg-gray-100 group">
                                                    <img 
                                                        src={img} 
                                                        className="w-full h-48 object-cover transition-transform duration-500 group-hover:scale-105 cursor-zoom-in" 
                                                        alt={`${selectedGalleryImage.title} - ${index + 1}`} 
                                                        onClick={() => setZoomedImage(img)}
                                                    />
                                                    <div className="absolute inset-0 pointer-events-none bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center">
                                                        <Icon name="image" className="text-white opacity-0 group-hover:opacity-100 transition-opacity w-8 h-8 drop-shadow-md" />
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    <div className="text-center">
                                        <button 
                                            onClick={() => setSelectedGalleryImage(null)}
                                            className="px-6 py-2 bg-red-600 text-white rounded-full text-sm font-semibold hover:bg-red-700 transition-colors"
                                        >
                                            Tutup Galeri
                                        </button>
                                    </div>
                                </div>
                            )}
                        </Modal>

                        {/* Login Modal */}
                        {showLoginModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[70] p-4 animate-fade-in">
                                <div className="bg-white rounded-lg max-w-sm w-full p-6 shadow-2xl relative">
                                    <button onClick={() => setShowLoginModal(false)} className="absolute top-4 right-4 text-gray-500 hover:text-red-500">
                                        <Icon name="x" className="w-5 h-5" />
                                    </button>
                                    <h3 className="text-xl font-bold text-gray-800 mb-4 text-center">Login Admin</h3>
                                    <form onSubmit={handleLogin} className="space-y-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">PIN Admin</label>
                                            <input 
                                                type="password" 
                                                value={loginPassword} 
                                                onChange={(e) => setLoginPassword(e.target.value)} 
                                                className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none text-center tracking-widest text-lg" 
                                                placeholder=""
                                                autoFocus
                                            />
                                        </div>
                                        <button type="submit" className="w-full bg-red-600 text-white py-2 rounded-lg font-bold hover:bg-red-700 transition-colors">
                                            Masuk
                                        </button>
                                        <p className="text-xs text-center text-gray-400">Gunakan PIN: 123456</p>
                                    </form>
                                </div>
                            </div>
                        )}

                        {/* Modal Konfirmasi Hapus Data */}
                        {deleteModalOpen && (
                            <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4 animate-fade-in">
                                <div className="bg-white rounded-lg max-w-sm w-full p-6 shadow-2xl">
                                    <div className="text-center mb-6">
                                        <div className="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <Icon name="trash" className="w-8 h-8" />
                                        </div>
                                        <h3 className="text-xl font-bold text-gray-900">Hapus Data?</h3>
                                        <p className="text-gray-500 text-sm mt-2">
                                            Apakah Anda yakin ingin menghapus data ini? Tindakan ini tidak dapat dibatalkan.
                                        </p>
                                    </div>
                                    <div className="flex gap-3">
                                        <button 
                                            onClick={() => setDeleteModalOpen(false)}
                                            className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold transition-colors"
                                        >
                                            Batal
                                        </button>
                                        <button 
                                            onClick={executeDelete}
                                            className="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold transition-colors shadow"
                                        >
                                            Ya, Hapus
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                    </main>

                    {/* Lightbox Zoom Overlay */}
                    {zoomedImage && (
                        <div 
                            className="fixed inset-0 z-[100] bg-black bg-opacity-95 flex items-center justify-center p-4 animate-fade-in cursor-zoom-out"
                            onClick={() => setZoomedImage(null)}
                        >
                            <button 
                                className="absolute top-6 right-6 text-white hover:text-red-500 transition-colors z-[101]"
                                onClick={() => setZoomedImage(null)}
                            >
                                <Icon name="x" className="w-10 h-10" />
                            </button>
                            <img 
                                src={zoomedImage} 
                                alt="Zoomed View" 
                                className="max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl"
                                onClick={(e) => e.stopPropagation()} 
                            />
                        </div>
                    )}

                    {/* Footer */}
                    <footer id="kontak" className="bg-gray-900 text-gray-300 py-12">
                        <div className="container mx-auto px-4">
                            <div className="grid md:grid-cols-3 gap-8 mb-8">
                                <div>
                                    <h4 className="text-white font-bold text-lg mb-4">SD NEGERI 0207 PANGIRKIRAN</h4>
                                    <p className="text-sm mb-4">Membangun generasi cerdas, berkarakter, dan berakhlak mulia.</p>
                                    <div className="space-y-2 text-sm">
                                        <div className="flex items-start gap-2">
                                            <Icon name="map-pin" className="w-5 h-5 mt-1 text-red-500" />
                                            <span>Desa Pangirkiran Dolok, Kec. Barumun Tengah, Kab. Padang Lawas, Sumatera Utara.</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <Icon name="mail" className="w-5 h-5 text-red-500" />
                                            <a href="mailto:sdn0211pangirkiran@gmail.com" className="hover:text-white">sdn0211pangirkiran@gmail.com</a>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 className="text-white font-bold text-lg mb-4">Tautan Penting</h4>
                                    <ul className="space-y-2 text-sm">
                                        <li><a href="https://dapo.kemendikdasmen.go.id/" target="_blank" className="hover:text-red-400 flex items-center gap-2"><Icon name="external-link" className="w-3 h-3" /> Dapodik</a></li>
                                        <li><a href="https://gurudikdas.dikdasmen.go.id/" target="_blank" className="hover:text-red-400 flex items-center gap-2"><Icon name="external-link" className="w-3 h-3" /> Guru Dikdas</a></li>
                                        <li><a href="https://kemendikdasmen.go.id/" target="_blank" className="hover:text-red-400 flex items-center gap-2"><Icon name="external-link" className="w-3 h-3" /> Kemendikdasmen</a></li>
                                        <li><a href="https://gtk.kemendikdasmen.go.id/" target="_blank" className="hover:text-red-400 flex items-center gap-2"><Icon name="external-link" className="w-3 h-3" /> Info GTK</a></li>
                                        <li><a href="https://guru.kemendikdasmen.go.id/" target="_blank" className="hover:text-red-400 flex items-center gap-2"><Icon name="external-link" className="w-3 h-3" /> Platform Merdeka Mengajar</a></li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 className="text-white font-bold text-lg mb-4">Lokasi Kami</h4>
                                    <div className="rounded-lg overflow-hidden h-40 border border-gray-700">
                                        <iframe 
                                            width="100%" 
                                            height="100%" 
                                            frameBorder="0" 
                                            scrolling="no" 
                                            marginHeight="0" 
                                            marginWidth="0" 
                                            src="https://maps.google.com/maps?q=1.366409,99.795892&hl=id&z=14&output=embed">
                                        </iframe>
                                    </div>
                                    <a href="https://maps.google.com/maps?q=1.366409,99.795892" target="_blank" className="text-xs text-red-400 mt-2 block hover:underline">Buka di Google Maps</a>
                                </div>
                            </div>
                            <div className="border-t border-gray-800 pt-8 text-center text-sm relative">
                                <p>&copy; 2025 SD Negeri 0207 Pangirkiran. All rights reserved.</p>
                                <p className="text-xs text-gray-500 mt-2">Pengelola Situs: Sofyan Tanjung</p>
                                
                                {/* Admin Login Trigger */}
                                <button 
                                    onClick={() => setShowLoginModal(true)} 
                                    className="absolute bottom-0 right-0 text-gray-700 hover:text-gray-500 p-2 opacity-50 hover:opacity-100"
                                    title="Login Admin"
                                >
                                    <Icon name="lock" className="w-4 h-4" />
                                </button>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>